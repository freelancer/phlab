error_log stderr;

events {}

http {
  access_log off;
  client_max_body_size 32M;
  gzip on;

  map $request_uri $request_uri_path {
    ~^(?P<path>[^?]*) $path;
  }

  server {
    location / {
      root /usr/local/src/phabricator/webroot;
      include /etc/nginx/fastcgi_params;

      fastcgi_pass web:8080;
      fastcgi_param QUERY_STRING __path__=$request_uri_path&$query_string;
      fastcgi_param SCRIPT_FILENAME $document_root/index.php;
    }
  }
}
